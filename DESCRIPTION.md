# Цель приложения
Это приложение реализует административную часть приложения Atom Dobro — платформы для благотворительности и волонтёрства, объединяющей организации и активных граждан для совместного решения социальных задач.

# Возможности приложения

## Управление пользователями
- Создание и управление пользовательскими аккаунтами
- Система ролей: администратор и обычный пользователь
- Управление профилями пользователей (обновление данных, аватаров)
- Смена паролей
- Просмотр списка всех пользователей (только для администраторов)

## Управление квестами
Квесты — это задания с этапами, которые участники могут выполнить тремя способами:
- **Финансово** — денежные взносы
- **Материально** — предоставление необходимых ресурсов
- **Волонтёрством** — личное участие и помощь

### Функциональность:
- Создание квестов пользователями с уровнем 5+ (уровень рассчитывается на основе опыта)
- Управление этапами квеста — шагами для достижения поставленной цели
- Настройка требований — минимальных условий для завершения квеста
- Фильтрация квестов по статусу (активные, архивированные, завершённые), городу и категории
- Присоединение и выход пользователей из квестов
- Завершение квестов с автоматическим начислением достижений
- Архивация и разархивация квестов
- Просмотр квестов пользователя и доступных квестов
- Real-time события квестов через Server-Sent Events (SSE)
- Обновление прогресса выполнения требований в этапах

## Управление организациями
Организации создаются пользователями с уровнем 5+, но требуют модерации администратором перед публикацией.

### Функциональность:
- Создание организаций пользователями (требуется уровень 5+)
- Модерация организаций администраторами (подтверждение/отклонение)
- Управление владельцами организаций (добавление/удаление)
- Управление видами помощи организации — типами ресурсов, которыми организация может помочь
- Массовое создание организаций (bulk import)
- Загрузка и управление галереей изображений организаций (до 20 файлов, до 10MB каждый)
- Хранение изображений в S3-совместимом хранилище
- Фильтрация организаций по статусу подтверждения
- Обновление информации об организациях

## Система достижений и опыта
- Создание и управление достижениями
- Автоматическое начисление достижений пользователям при выполнении квестов (если пользователь оставил вклад: финансово, материально или волонтёрством)
- Каждое достижение имеет цену в виде опыта
- Автоматическое начисление опыта после выдачи достижения
- Система уровней на основе накопленного опыта
- Просмотр достижений конкретного пользователя
- Ручное присвоение достижений администраторами

## Географические данные
- Управление регионами и городами (только для администраторов)
- Массовое создание городов
- Получение списка городов по региону
- Связь организаций и квестов с географическими локациями

## Категории и типы
- Управление категориями квестов
- Управление типами организаций
- Управление видами помощи (help-types)
- Массовое создание категорий

## Статистика системы
- Общая статистика платформы:
  - Количество городов и регионов
  - Количество пользователей
  - Количество организаций
  - Общее количество квестов
  - Количество активных квестов
  - Количество завершённых квестов

## Аутентификация и авторизация
- JWT-аутентификация с поддержкой access и refresh токенов
- Вход в систему (только для администраторов)
- Обновление токенов
- Валидация токенов
- Защита эндпоинтов с помощью guards
- Логирование попыток входа для мониторинга безопасности

## Загрузка файлов
- Загрузка изображений для организаций
- Валидация файлов (тип, размер, расширение)
- Интеграция с S3-совместимыми хранилищами (AWS S3, Yandex Object Storage, Beget и др.)
- Проксирование изображений через API

## Мониторинг и метрики
- Интеграция с Prometheus для сбора метрик
- Метрики HTTP-запросов (количество, длительность, ошибки)
- Метрики попыток входа в систему
- Экспорт метрик для мониторинга производительности

## Обновления и история
- Управление обновлениями квестов (quest-updates)
- Управление обновлениями организаций (organization-updates)
- Отслеживание изменений в системе

## Технические особенности
- RESTful API на базе NestJS
- Версионирование API (v1, v2)
- Swagger документация для всех эндпоинтов
- Валидация данных с помощью Zod
- Поддержка CORS для работы с фронтендом
- Глобальный префикс API: `/admin/api`
- Server-Sent Events для real-time обновлений
- Логирование запросов к организациям
- Soft delete для безопасности данных

## Безопасность
- Хеширование паролей с помощью bcrypt
- JWT токены с настраиваемым временем жизни
- Разделение прав доступа между администраторами и обычными пользователями
- Валидация всех входящих данных
- Защита от несанкционированного доступа к административным функциям